name: "Tech Stack Security Analysis"
queries:
  - uses: github/codeql-go//...
  - uses: github/codeql-java//...
  - uses: github/codeql-javascript//...
  - uses: github/codeql-csharp//...
  - uses: github/codeql-python//...
  - uses: github/codeql-php//...

paths:
  - "envoy-proxy/"
  - "frontend/"
  - "ad-service/"
  - "microblog-service/"
  - "proxy-service/"
  - "profile-service/"
  - "membership-service/"
  - "like-service/"
  - "user-auth-service/"
  - "status-service/"
  - "payment-service/"
  - "jaeger/"
  - "mariadb/"
  - "redis/"
  - "user-simulator/"
  - "malicious-load-generator/"

exclusions:
  - "**/node_modules/"
  - "**/lib/"
  - "**/dependencies/"
  - "**/vendor/"

libraries:
  # Specify libraries or frameworks to better focus the analysis
  - name: "Express"
    language: "javascript"
  - name: "Spring Framework"
    language: "java"
  - name: ".NET"
    language: "csharp"
  - name: "Flask"
    language: "python"
  - name: "Puppeteer"
    language: "javascript"

suites:
  # Include built-in security suites tailored to each language
  - name: "security-extended"
    language: "javascript"
  - name: "security-and-quality"
    language: "java"
  - name: "security-extended"
    language: "csharp"
  - name: "security-extended"
    language: "python"
  - name: "security-extended"
    language: "php"

# Optional: Define additional configuration for more targeted analysis
overrides:
  - file: "**/proxy-service/**/*.java"
    queries:
      - uses: "./custom-queries/java/ssrf-query.ql"
  - file: "**/profile-service/**/*.java"
    queries:
      - uses: "./custom-queries/java/sql-injection.ql"
  - file: "**/status-service/**/*.go"
    queries:
      - uses: "./custom-queries/go/sql-injection.ql"
  - file: "**/user-auth-service/**/*.js"
    queries:
      - uses: "./custom-queries/javascript/jwt-key-confusion.ql"
